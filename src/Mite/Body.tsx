import React, { CSSProperties, useEffect, useRef } from 'react';
import anime from 'animejs';
import { Color, Shape } from '../types';

export const Shapes: Record<Shape, string> = {
  [Shape.Egg]:
    'M832,635C831,677 826,713 817,745C805,787 786,821 762,848C733,880 696,903 653,918C607,933 555,940 500,939C455,938 412,934 372,925C326,913 284,894 251,865C227,842 207,814 193,778C178,742 170,697 170,643C170,587 181,511 201,433C211,391 225,347 241,306C262,254 286,205 314,165C357,101 409,60 468,60C520,61 574,90 622,137C653,167 682,203 708,244C741,294 768,351 789,409C817,486 833,565 832,635',
  [Shape.Trapezoid]:
    'M901,569C913,617 946,747 955,785C958,796 958,811 950,823C940,837 925,854 894,854C845,854 546,855 491,854C446,854 142,852 101,852C85,851 60,842 51,826C36,800 42,783 50,770C71,736 107,680 139,628C168,580 245,457 285,393C291,384 297,377 310,370C316,368 324,365 333,364C409,355 481,349 549,341C601,334 749,319 782,316C799,314 813,318 823,324C831,330 842,335 847,357C870,443 882,494 901,569Z',
  [Shape.Triangle]:
    'M818,604C844,647 906,742 927,783C932,793 931,808 923,820C913,835 892,841 861,841C812,841 526,839 471,839C426,838 135,839 95,838C79,838 68,834 58,818C44,792 63,769 70,755C90,719 120,672 154,614C182,565 194,546 234,481C240,472 294,390 312,364C355,303 446,167 452,159C462,146 494,103 501,103C512,104 534,143 545,157C555,172 601,256 640,321C692,406 745,490 758,508C787,553 796,568 818,604Z',
  [Shape.Circle]:
    'M855,551C856,588 850,640 841,672C829,714 798,776 775,804C748,837 691,883 650,901C619,914 556,938 500,939C455,940 410,933 372,919C338,906 273,859 243,825C218,797 193,756 179,720C165,683 147,618 145,577C145,550 144,489 158,436C169,393 187,355 216,321C242,291 272,265 315,241C361,216 452,196 494,195C547,194 616,203 660,221C702,237 738,263 766,295C792,326 819,381 833,418C848,459 853,499 855,551Z',
  [Shape.Rectangle]:
    'M928,656C928,706 937,768 937,809C937,821 940,820 933,833C931,839 929,839 920,839C872,840 475,836 420,835C375,835 247,839 99,841C83,842 66,845 59,839C52,834 56,805 56,790C57,750 58,603 59,543C60,477 57,418 56,351C56,341 56,339 59,336C65,332 69,333 78,333C150,330 424,334 547,333C711,331 857,327 890,324C907,322 912,323 922,329C930,334 927,348 927,358C928,477 926,528 928,656Z',
  [Shape.Square]:
    'M879,658C881,732 889,825 889,886C889,903 892,902 886,921C884,929 882,929 874,929C831,930 479,921 430,920C390,919 276,924 144,927C130,927 115,932 108,924C102,915 106,873 106,851C106,792 106,575 106,485C107,389 104,301 102,203C102,187 102,185 105,181C110,175 113,176 122,176C186,172 430,181 539,179C684,177 814,173 844,168C859,166 863,166 872,176C879,184 877,205 877,220C878,394 877,470 879,658Z',
};

const Body: React.FC<{ shape: Shape; color: Color }> = ({ shape, color }) => {
  const shapeWas = useRef<Shape>(shape);

  const outlineRef = useRef<SVGPathElement>(null);
  const fillRef = useRef<SVGPathElement>(null);

  useEffect(() => {
    anime({
      targets: [outlineRef.current, fillRef.current],
      d: Shapes[shape],
      easing: 'spring(1, 90, 7, 0)',
    });
  }, [shape]);

  return (
    <g className="body">
      <path
        ref={fillRef}
        className="body__fill"
        d={Shapes[shapeWas.current]}
        pathLength={1}
        style={{ fill: `var(--${color})` }}
      />
      <path
        ref={outlineRef}
        className="body__outline outline"
        d={Shapes[shapeWas.current]}
        pathLength={1}
      />
    </g>
  );
};

export default Body;
